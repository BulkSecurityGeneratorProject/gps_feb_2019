os:
- linux
services:
- docker
language: node_js
node_js:
- 10.15.0
jdk:
- oraclejdk8
sudo: false
cache:
  directories:
  - node
  - node_modules
  - "$HOME/.m2"
env:
  global:
  - NODE_VERSION=10.15.0
  - SPRING_OUTPUT_ANSI_ENABLED=ALWAYS
  - SPRING_JPA_SHOW_SQL=false
  - JHI_DISABLE_WEBPACK_LOGS=true
  - secure: LS3PUVvTVQ0v6PV+sRH8zHHtzqFJrQQvEptrjg3pIwTPTVz2xa5XQz8if6GCkQss6F0C3XodMkdbaLxtzCe0upDF4P6pEhjr3JgkKxIj9l04HnmMIkKD+P0El37+bVsdfMEUWdPll0fVdo5CvJ1Xhs1kgOakokYwDXbdAsdX+73RHadeNQgD9ub2BJiKEkOSk9SxxxlihPZ857zVskoStviV3JF3JH+jK6H6HjyS46Cv5unq4dFORyW2xt0l6AJOxXdCW4V+J1nsFssv9YvgQQ0LLAYeFlGPD4IONODx4GhvdWxi2NCEpkmxjbH2N7vMQF8UZr1y9txq1fiMxAtmZB2+Hum/q4It7UFtSdEVFHB98PRDmGG54q5ymaOy/zDfuzan1f6VpGv5C3X4uEKylWIRGNbsvuNnUDf4TC8h1wveYJ/pigpbGM7npda+FZloPKhaeABp3WbRoyIb66Sac2H6LbfZqdkLUkMEudllq8JbuMqfqBmbtPWnUYuR+/2AyzzERwjEYyYoGaafu4AcpmOeQraojliBRuGntrsjZ7gs1921N25iGofR/k+SmSy9rSG1+TbAseh8iBTYsKyXDrqubgZJS5FvGNvG69zCy5Aobi7qpRlYILQdrKXyp4e/2hXKQSRNY6zWqxbkk5KlDCBoZ+1wsGLAOiW3+F2lkn4= #DOCKER_USER
  - secure: m/26dJYUeHpdSxi/1x86ZfKSL9JEhChWrKeS4fcqJinsIF3/YSIFnSOqVzbe/W94NLeQLlsUEJIvZtYcQrKcg1DSTNp/L/5jby6xTbSFWnyU8hB3ylioIA1SHw6eVynbtJtrReX8/kL1gPM9zK0mFd2Nzrae0XF+9RnuXuKkpn4lh2DuVkUDCu8rj+ItDebfi856wcJHYvQQmcb/v23/2C6h2ES8cO206JwGJ2QaFYvrRXS2iEn1sP96VKeHVjoM2rM8CPT9DFCf8XLE2Ha+6+ErZtoOwEGUAHvQIOr8rd2wTU++hmzKpe4vih8YKFvfKgTwr3UMw7KkHUdjkPl2CCxTtpTVE2mEEfsXhJaTN4bZKxHQ6HLNqyhZESJ+PcuoymD20HqtC4/SrutngpgElvBupkiMzL4cGamvOF10V6D81js1f4PMQx3rpTMqZICVfWCoyo1wljGyfwDy7W3RNGlTUFNKKOMl2zwLWNj44GHDgdVdEUbWPbfVJ1S5NF/N5uligtRN+FjngClDJCdbNsAksgVwF7+hfqaPUgkHp8luASmeOyHCmtWxxSdnRLGdpRkw0wFNT6rQv3WQ+apAK7DQzYV4K74ciUp7oVYdDbT4aKzdWApwrQ65yrYgxBCR0PhAPPO7TpjFZDOgvBiOq9BjG4ax0IiD1IhE0cQ8i+0= #DOCKER_PASS
  - COMMIT=${TRAVIS_COMMIT::7}
before_install:
- jdk_switcher use oraclejdk8
- java -version
- sudo /etc/init.d/mysql stop
- sudo /etc/init.d/postgresql stop
- nvm install $NODE_VERSION
- npm install -g npm
- node -v
- npm -v
install:
- npm install
script:
- chmod +x mvnw
- "./mvnw clean test"
- "./mvnw com.github.eirslett:frontend-maven-plugin:npm -Dfrontend.npm.arguments='run
  test-ci' -Dmaven.repo.local=$MAVEN_USER_HOME"
#- "./mvnw verify -Pprod -DskipTests"
- "./mvnw package -DSkipTests=true -Pprod jib:dockerBuild"
#- "./mvnw com.heroku.sdk:heroku-maven-plugin:2.0.5:deploy -DskipTests -Pprod -Dheroku.buildpacks=heroku/jvm
#  -Dheroku.appName=gps-netra"
notifications:
  webhooks:
    on_success: change
    on_failure: always
    on_start: false
after_success:
- docker login -u $DOCKER_USER -p $DOCKER_PASS
- export TAG=latest
- export IMAGE_NAME=udaysalian/gps_feb_2019
- docker tag gps_feb_2019 $IMAGe_NAME:$TAG
- docker push $IMAGE_NAME
